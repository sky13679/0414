<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>å¤©æ°£é å ± (36 å°æ™‚)</title>
  </head>
  <body>
    <h1>å…¨å°æœ€é«˜ / æœ€ä½æº«åŸå¸‚</h1>
    <div id="weatherResult">è¼‰å…¥ä¸­â€¦</div>

    <script>
      const apiUrl = 'https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWB-FE4AD205-4642-40AD-B7FD-336A53D1ED2A';
      const weatherResult = document.getElementById('weatherResult');

      async function loadWeather() {
        try {
          const resp = await fetch(apiUrl);
          if (!resp.ok) throw new Error(`HTTP éŒ¯èª¤ï¼š${resp.status}`);
          const data = await resp.json();
          const locations = data.records.location;
          if (!locations || !locations.length) {
            weatherResult.textContent = 'æœªå–å¾—ä»»ä½•å¤©æ°£è³‡æ–™';
            return;
          }

          let maxTempCity = '', maxTemp = -Infinity;
          let minTempCity = '', minTemp = Infinity;

          locations.forEach(loc => {
            const name = loc.locationName;

            const maxT = loc.weatherElement.find(e => e.elementName === 'MaxT');
            const maxVal = maxT && maxT.time[0] ? parseInt(maxT.time[0].parameter.parameterName, 10) : null;

            const minT = loc.weatherElement.find(e => e.elementName === 'MinT');
            const minVal = minT && minT.time[0] ? parseInt(minT.time[0].parameter.parameterName, 10) : null;

            if (maxVal !== null && maxVal > maxTemp) {
              maxTemp = maxVal;
              maxTempCity = name;
            }

            if (minVal !== null && minVal < minTemp) {
              minTemp = minVal;
              minTempCity = name;
            }
          });

          weatherResult.innerHTML = `
            <p>ğŸŒ æœ€é«˜æº«åŸå¸‚ï¼š${maxTempCity}ï¼ˆ${maxTemp}Â°Cï¼‰</p>
            <p>â„ï¸ æœ€ä½æº«åŸå¸‚ï¼š${minTempCity}ï¼ˆ${minTemp}Â°Cï¼‰</p>
          `;
        } catch (err) {
          weatherResult.textContent = 'è¼‰å…¥å¤±æ•—ï¼š' + err.message;
        }
      }

      loadWeather();
    </script>
  </body>
</html>
